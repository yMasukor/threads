<!doctype html>
<html>
	<head>
	<script src="lib/jquery-2.1.3.min.js"></script>
	<script src="lib/tween.min.js"></script>
    <script src="lib/tsw.js"></script>
	<script src="lib/two.js"></script>

	<script src="https://cdn.socket.io/socket.io-1.3.3.js"></script>
	


	</head>
	<body>

	<script>

		var TWO_PI = Math.PI * 2;

        var width = $(window).width(), height = $(window).height();
        var center = {x: width/2, y:height/2}

        // var duration = sixteenthNoteDuration*16;
        var animations = {}
        var Easing = TWEEN.Easing;

        var socket = io();


       



		var two = new Two({
			fullscreen: true,
			type: Two.Types.svg,
		}).appendTo(document.body);


		// two.renderer.domElement.style.background = randomColor();


		console.log(width, height, center, two.renderer);




		


        




















        
		function Player(id){
			this.id = id;
			this.thread = null;
		}









		var players = [];


        
		


		$(document).ready(function(){

			//bind sockets

			//connect to the server
			socket.emit('connectPlayer');


			two.bind('update', function(frameCount) {
				// console.log('update');
                TWEEN.update();
	           
		

	      	}).play();

	      	$(window).bind('mousedown', dragStart);
            $(window).bind('mousemove', drag);
            $(window).bind('mouseup', dragEnd);

            $('body').bind('touchstart', function(event){
                var e = event.originalEvent
                dragStart(e.touches[0]);
                return false;
            });
            $('body').bind('touchmove', function(event){
                var e = event.originalEvent
                drag(e.touches[0]);
                return false;
            });
            $('body').bind('touchend', function(event){


                var e = event.originalEvent
                 console.log(e);
                dragEnd(e.changedTouches[0]);
                return false;
            });

            $('body').bind('touchcancel', function(event){
                return false;
            });

		});



        var isDragging

        var dragStart = function(e){
            // e.preventDefault();
            isDragging = true;

            var input = {
                type:'start',
                x:e.clientX,
                y:e.clientY,
            }

            socket.emit('playerInput', input);

            
        }

        var drag = function(e){
            // e.preventDefault();
            if(isDragging){
                var input = {
                    type:'drag',
                    x:e.clientX,
                    y:e.clientY,
                }

                socket.emit('playerInput', input);
            }

            return false;
        }

        var dragEnd = function(e){
            // e.preventDefault();
            isDragging = false;

            var input = {
                type:'end',
                x:e.clientX,
                y:e.clientY,
            }

            socket.emit('playerInput', input);

            return false;
        }



	</script>
	</body>
</html>